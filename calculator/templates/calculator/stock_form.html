{% extends 'calculator/base.html' %}
{% load crispy_forms_tags %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">{{ title }}</h3>
            </div>
            <div class="card-body">
                <form method="post" id="stockForm">
                    {% csrf_token %}
                    {{ form.material|as_crispy_field }}
                    {{ form.section_type|as_crispy_field }}
                    {{ form.quantity|as_crispy_field }}
                    
                    <div id="sheet-fields" style="display: none;">
                        <h5 class="mt-3">Параметры листа</h5>
                        {{ form.length|as_crispy_field }}
                        {{ form.width|as_crispy_field }}
                        {{ form.height|as_crispy_field }}
                    </div>
                    
                    <div id="round-fields" style="display: none;">
                        <h5 class="mt-3">Параметры кругляка</h5>
                        {{ form.diameter|as_crispy_field }}
                        {{ form.round_length|as_crispy_field }}
                    </div>
                    
                    <div id="hexagon-fields" style="display: none;">
                        <h5 class="mt-3">Параметры шестигранника</h5>
                        {{ form.key_size|as_crispy_field }}
                        {{ form.hex_length|as_crispy_field }}
                    </div>
                    
                    <div class="d-flex justify-content-between mt-4">
                        <button type="submit" class="btn btn-primary">Сохранить</button>
                        <a href="{% url 'stock_list' %}" class="btn btn-secondary">Отмена</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const sectionType = document.getElementById('id_section_type');
    const sheetFields = document.getElementById('sheet-fields');
    const roundFields = document.getElementById('round-fields');
    const hexagonFields = document.getElementById('hexagon-fields');
    
    function toggleFields() {
        const value = sectionType.value;
        sheetFields.style.display = 'none';
        roundFields.style.display = 'none';
        hexagonFields.style.display = 'none';
        
        if (value === 'sheet') {
            sheetFields.style.display = 'block';
        } else if (value === 'round') {
            roundFields.style.display = 'block';
        } else if (value === 'hexagon') {
            hexagonFields.style.display = 'block';
        }
    }
    
    sectionType.addEventListener('change', toggleFields);
    toggleFields(); // Initial call
});
</script>
{% endblock %}